\chapter{Test\+Player\+Build\+Modifier attribute}
\hypertarget{md__library_2_package_cache_2com_8unity_8test-framework_0d1_81_833_2_documentation_0i_2referenceb8c126674b70f20694ef63d23389a4ea}{}\label{md__library_2_package_cache_2com_8unity_8test-framework_0d1_81_833_2_documentation_0i_2referenceb8c126674b70f20694ef63d23389a4ea}\index{TestPlayerBuildModifier attribute@{TestPlayerBuildModifier attribute}}
\label{md__library_2_package_cache_2com_8unity_8test-framework_0d1_81_833_2_documentation_0i_2referenceb8c126674b70f20694ef63d23389a4ea_autotoc_md579}%
\Hypertarget{md__library_2_package_cache_2com_8unity_8test-framework_0d1_81_833_2_documentation_0i_2referenceb8c126674b70f20694ef63d23389a4ea_autotoc_md579}%
 You can use the {\ttfamily Test\+Player\+Build\+Modifier} attribute to accomplish a couple of different scenarios\+:\hypertarget{md__library_2_package_cache_2com_8unity_8test-framework_0d1_81_833_2_documentation_0i_2referenceb8c126674b70f20694ef63d23389a4ea_autotoc_md580}{}\doxysection{\texorpdfstring{Modify the Player build options for Play Mode tests}{Modify the Player build options for Play Mode tests}}\label{md__library_2_package_cache_2com_8unity_8test-framework_0d1_81_833_2_documentation_0i_2referenceb8c126674b70f20694ef63d23389a4ea_autotoc_md580}
It is possible to change the \href{https://docs.unity3d.com/ScriptReference/BuildPlayerOptions.html}{\texttt{ Build\+Player\+Options}} for the test {\bfseries{Player}}, to achieve custom behavior when running {\bfseries{Play Mode}} tests. Modifying the build options allows for changing the target location of the build as well as changing \href{https://docs.unity3d.com/ScriptReference/BuildOptions.html}{\texttt{ Build\+Options}}.

To modify the {\ttfamily Build\+Player\+Options}, do the following\+:


\begin{DoxyItemize}
\item Implement the {\ttfamily ITest\+Player\+Build\+Modifier}
\item Reference the implementation type in a {\ttfamily Test\+Player\+Build\+Modifier} attribute on an assembly level.
\end{DoxyItemize}\hypertarget{md__library_2_package_cache_2com_8unity_8test-framework_0d1_81_833_2_documentation_0i_2referenceb8c126674b70f20694ef63d23389a4ea_autotoc_md581}{}\doxysubsection{\texorpdfstring{Example}{Example}}\label{md__library_2_package_cache_2com_8unity_8test-framework_0d1_81_833_2_documentation_0i_2referenceb8c126674b70f20694ef63d23389a4ea_autotoc_md581}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\ \#}}
\DoxyCodeLine{\textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_unity_editor}{UnityEditor}};}
\DoxyCodeLine{\textcolor{keyword}{using\ }UnityEditor.TestTools;}
\DoxyCodeLine{}
\DoxyCodeLine{[assembly:TestPlayerBuildModifier(typeof(BuildModifier))]}
\DoxyCodeLine{\textcolor{keyword}{public}\ \textcolor{keyword}{class\ }BuildModifier\ :\ \mbox{\hyperlink{interface_unity_editor_1_1_test_tools_1_1_i_test_player_build_modifier}{ITestPlayerBuildModifier}}}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ BuildPlayerOptions\ ModifyOptions(BuildPlayerOptions\ playerOptions)}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (playerOptions.target\ ==\ BuildTarget.iOS)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ playerOptions.options\ |=\ BuildOptions.SymlinkLibraries;\ \textcolor{comment}{//\ Enable\ symlink\ libraries\ when\ running\ on\ iOS}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ playerOptions.options\ |=\ BuildOptions.AllowDebugging;\ \textcolor{comment}{//\ Enable\ allow\ Debugging\ flag\ on\ the\ test\ Player.}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ playerOptions;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}


\begin{quote}
{\bfseries{Note\+:}} When building the Player, it includes all {\ttfamily Test\+Player\+Build\+Modifier} attributes across all loaded assemblies, independent of the currently used test filter. As the implementation references the {\ttfamily \doxylink{namespace_unity_editor}{Unity\+Editor}} namespace, the code is typically implemented in an Editor only assembly, as the {\ttfamily \doxylink{namespace_unity_editor}{Unity\+Editor}} namespace is not available otherwise. \end{quote}
\hypertarget{md__library_2_package_cache_2com_8unity_8test-framework_0d1_81_833_2_documentation_0i_2referenceb8c126674b70f20694ef63d23389a4ea_autotoc_md582}{}\doxysection{\texorpdfstring{Split build and run}{Split build and run}}\label{md__library_2_package_cache_2com_8unity_8test-framework_0d1_81_833_2_documentation_0i_2referenceb8c126674b70f20694ef63d23389a4ea_autotoc_md582}
It is possible to use the \doxylink{namespace_unity}{Unity} Editor for building the Player with tests, without \doxysectlink{md__library_2_package_cache_2com_8unity_8test-framework_0d1_81_833_2_documentation_0i_2workflow-run-playmode-test-standalone}{running the tests}{0}. This allows for running the Player on e.\+g. another machine. In this case, it is necessary to modify the Player to build and implement a custom handling of the test result.

By using {\ttfamily Test\+Player\+Build\+Modifier}, you can alter the {\ttfamily Build\+Options} to not start the Player after the build as well as build the Player at a specific location. Combined with \href{./reference-setup-and-cleanup.md\#prebuildsetup-and-postbuildcleanup}{\texttt{ Post\+Build\+Cleanup}}, you can automatically exit the Editor on completion of the build.\hypertarget{md__library_2_package_cache_2com_8unity_8test-framework_0d1_81_833_2_documentation_0i_2referenceb8c126674b70f20694ef63d23389a4ea_autotoc_md583}{}\doxysubsection{\texorpdfstring{Example}{Example}}\label{md__library_2_package_cache_2com_8unity_8test-framework_0d1_81_833_2_documentation_0i_2referenceb8c126674b70f20694ef63d23389a4ea_autotoc_md583}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\ \#}}
\DoxyCodeLine{\textcolor{keyword}{using\ }System;}
\DoxyCodeLine{\textcolor{keyword}{using\ }System.IO;}
\DoxyCodeLine{\textcolor{keyword}{using\ }System.Linq;}
\DoxyCodeLine{\textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_tests}{Tests}};}
\DoxyCodeLine{\textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_unity_editor}{UnityEditor}};}
\DoxyCodeLine{\textcolor{keyword}{using\ }UnityEditor.TestTools;}
\DoxyCodeLine{\textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_unity_engine}{UnityEngine}};}
\DoxyCodeLine{\textcolor{keyword}{using\ }UnityEngine.TestTools;}
\DoxyCodeLine{}
\DoxyCodeLine{[assembly:TestPlayerBuildModifier(typeof(HeadlessPlayModeSetup))]}
\DoxyCodeLine{[assembly:PostBuildCleanup(typeof(HeadlessPlayModeSetup))]}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_tests}{Tests}}}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{class\ }HeadlessPlayModeSetup\ :\ \mbox{\hyperlink{interface_unity_editor_1_1_test_tools_1_1_i_test_player_build_modifier}{ITestPlayerBuildModifier}},\ \mbox{\hyperlink{interface_unity_engine_1_1_test_tools_1_1_i_post_build_cleanup}{IPostBuildCleanup}}}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ s\_RunningPlayerTests;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ BuildPlayerOptions\ ModifyOptions(BuildPlayerOptions\ playerOptions)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Do\ not\ launch\ the\ player\ after\ the\ build\ completes.}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ playerOptions.options\ \&=\ \string~BuildOptions.AutoRunPlayer;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ headlessBuildLocation\ to\ the\ output\ directory\ you\ desire.\ It\ does\ not\ need\ to\ be\ inside\ the\ project.}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ var\ headlessBuildLocation\ =\ Path.GetFullPath(Path.Combine(\mbox{\hyperlink{namespace_unity_1_1_visual_scripting_a84f7f8b69a898cf472e2c285c1b943b3ae498749f3c42246d50b15c81c101d988}{Application}}.dataPath,\ \textcolor{stringliteral}{"{}.//..//PlayModeTestPlayer"{}}));}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ var\ fileName\ =\ Path.GetFileName(playerOptions.locationPathName);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\textcolor{keywordtype}{string}.IsNullOrEmpty(fileName))}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ headlessBuildLocation\ =\ Path.Combine(headlessBuildLocation,\ fileName);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ playerOptions.locationPathName\ =\ headlessBuildLocation;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Instruct\ the\ cleanup\ to\ exit\ the\ Editor\ if\ the\ run\ came\ from\ the\ command\ line.\ }}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ variable\ is\ static\ because\ the\ cleanup\ is\ being\ invoked\ in\ a\ new\ instance\ of\ the\ class.}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ s\_RunningPlayerTests\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ playerOptions;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keywordtype}{void}\ Cleanup()}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (s\_RunningPlayerTests\ \&\&\ IsRunningTestsFromCommandLine())}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Exit\ the\ Editor\ on\ the\ next\ update,\ allowing\ for\ other\ PostBuildCleanup\ steps\ to\ run.}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EditorApplication.update\ +=\ ()\ =>\ \{\ EditorApplication.Exit(0);\ \};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ IsRunningTestsFromCommandLine()}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ var\ commandLineArgs\ =\ Environment.GetCommandLineArgs();}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ commandLineArgs.Any(value\ =>\ value\ ==\ \textcolor{stringliteral}{"{}-\/runTests"{}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}


If the Editor is still running after the Play Mode tests have run, the Player tries to report the results back, using \href{https://docs.unity3d.com/ScriptReference/Networking.PlayerConnection.PlayerConnection.html}{\texttt{ Player\+Connection}}, which has a reference to the IP address of the Editor machine, when built.

To implement a custom way of reporting the results of the test run, let one of the assemblies in the Player include a \doxysectlink{md__library_2_package_cache_2com_8unity_8test-framework_0d1_81_833_2_documentation_0i_2reference-attribute-testruncallback}{Test\+Run\+Callback}{0}. At {\ttfamily Run\+Finished}, it is possible to get the full test report as XML from the \href{http://www.nunit.org/}{\texttt{ NUnit}} test result by calling {\ttfamily result.\+To\+Xml(true)}. You can save the result and then save it on the device or send it to another machine as needed. 